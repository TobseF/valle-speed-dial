<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../vsc-fab-button/vsc-fab-button.html">

<dom-module id="vsc-fab-speed-dial">
  <template>

    <style>

      :host {
        display: inline-block;
        position: relative;
      }

      .fab {
        position: relative;
        z-index: 2;
        --vsc-fab-button-color: var(--vsc-fab-speed-dial-fab-color, #00b0ba);
        --vsc-fab-button-default-icon-color: var(--vsc-fab-speed-dial-default-icon-color, #ffffff);
        --vsc-fab-button-pressed-color: var(--vsc-fab-speed-dial-pressed-color, #00676d);
      }

      .speed-dial {
        padding-left: 0;
        margin-top: 0;
        margin-bottom: 0;
        position: absolute;
        z-index: 3;
        right: 8px;
        bottom: 70px; /* direction up - Default value*/
        display: flex;
        flex-direction: column;
      }

      :host([direction="down"]) .speed-dial {
        top: 70px;
      }

      :host([direction="up"]) .speed-dial {
        bottom: 70px;
      }

      :host([direction="left"]) .speed-dial {
        top: 10px;
        right: 70px;
        flex-direction: row;
      }

      :host([direction="right"]) .speed-dial {
        top: 10px;
        left: 70px;
        display: flex;
        flex-direction: row;
      }

      :host(.backdrop[backdrop])::after {
        content: '';
        position: fixed;
        z-index: 1;
        top: 0;
        left: 0;
        display: block;
        width: 100vw;
        height: 100vh;
        background-color: var(--vsc-fab-speed-dial-backdrop-color, rgba(0,0,0,.8));
        animation: fade .2s;
      }

      @keyframes fade {
        from {
          opacity: 0;
        },
        to {
          opacity: 1;
        }
      }

    </style>

    <vsc-fab-button
      toggle
      icon=[[icon]]
      label=[[label]]
      aria-haspopup="true"
      class="fab"
      id="fab">
    </vsc-fab-button>

    <ul class="speed-dial" id="speedDial" style="display: none;">
      <slot></slot>
    </ul>

  </template>

  <script>
    class vscFabSpeedDial extends Polymer.Element {

      static get is() { return 'vsc-fab-speed-dial'; }

      connectedCallback() {
        super.connectedCallback();

        this.setAttribute('role', 'navigation');

        Polymer.RenderStatus.afterNextRender(this, () => {
          this.$.fab.addEventListener('click', this._toggleShow.bind(this));
        });

      }

      _toggleShow() {

        if(this.$.speedDial.style.display == 'none') {
          this.$.speedDial.style.display = 'flex'
          this.classList.add('backdrop');
        } else {
          this.$.speedDial.style.display = 'none'
          this.classList.remove('backdrop');
        }

      }

      static get properties() {
        return {
          label: {
            type: String,
            value: ''
          },
          icon: {
            type: String,
            value: ''
          },
          backdrop: {
            type: Boolean,
            value: true
          },
        }
      }

    }

    window.customElements.define(vscFabSpeedDial.is, vscFabSpeedDial);
  </script>
</dom-module>
